## 简介

本文档为HERO2020赛季使用核心板的 BSP (板级支持包) 说明。

主要内容如下：
- 核心板引出资源介绍
- BSP 快速上手

通过阅读快速上手章节开发者可以快速地上手该 BSP，将 RT-Thread 运行在核心板上。

## 核心板介绍

核心板外观如下图所示：

![board](figures/board.jpg)

该核心板常用 **板载资源** 如下：

- MCU：STM32F427VI，主频 168MHz。
- 常用核心板外设
  - LED：2个（PC4,PE2）
  - 按键：1个（PC5）
  - RGB彩灯：1个（red:PE6,green:PE2,blue:PA2）
  - 拨码开关：2个（PE3,PA6）
  - 无源蜂鸣器：1个（PB10）
  - OTG接口：1个（D-:PA11,D+:PA12）
  - 其他功能清根据底板引出情况选择
- 常用接口：根据底板不同引出接口会不同
- 调试接口，标准 SWD

其他核板相关资料请参考子翔的[核心板使用说明](链接地址待补充)

## 外设支持

本 BSP 目前对外设的支持情况如下：

| **板载外设**      | **支持情况** | **备注**                              |
| :-----------------| :----------: | :-------------------------------------|
| CAN               |     支持     |  CAN1/2                               |
| **片上外设**      | **支持情况** | **备注**                              |
| GPIO              |     支持     | 所有引出的具有GPIO功能的引脚均可         |
| UART              |     支持     | UART1/3/6/7/8                         |
| SPI               |     支持     | SPI3/4                                |
| I2C               |     支持     | I2C1                                  |
| ADC               |     支持     | ADC1 CH3/10/11/12/13                  |
| DAC               |   暂不支持   | 即将支持                               |
| SDIO              |   暂不支持   | 即将支持                               |
| PWM               |     支持     | PWM1(CH1/2) 2(CH3) 4(CH1/2/3/4) 5(CH3) 8(CH3/4) 9(CH1/2)  |
| WDG               |     支持     | IWDG                                  |
| **扩展模块**      | **支持情况** | **备注**                              |
| 暂无              |              |                                       |

## 使用说明

使用说明分为如下两个章节：

- 快速上手

    本章节是为刚接触 RT-Thread 的新手准备的使用说明，遵循简单的步骤即可将 RT-Thread 操作系统运行在该核心板上，看到实验效果 。

- 进阶使用

    本章节是为需要在 RT-Thread 操作系统上使用更多核心板资源的开发者准备的。通过使用 ENV 工具对 BSP 进行配置，可以开启更多板载资源，实现更多高级功能。


### 快速上手

本 BSP 为开发者提供 MDK5 工程。下面介绍如何将系统运行起来。

#### 硬件连接

使用SWD连接核心板到 PC，打开电源开关。

#### 编译下载

双击 project.uvprojx 文件，打开 MDK5 工程，编译并下载程序到开发板。

> 工程默认配置使用 ST-Link 仿真器下载程序，在通过 ST-Link 连接开发板的基础上，点击下载按钮即可下载程序到开发板

#### 运行结果

下载程序成功之后，系统会自动运行，RGB灯颜色会变为白色，且由暗变亮，同时蜂鸣器会发出频率不断变高的声音。

连接核心板 UART8 到 PC , 在终端工具里打开相应的串口（115200-8-1-N），复位设备后，可以看到 RT-Thread 的输出信息:

```bash
 \ | /
- RT -     Thread Operating System
 / | \     3.1.1 build Nov 19 2018
 2006 - 2018 Copyright by rt-thread team
msh >
```
### 进阶使用

此 BSP 默认只开启了 GPIO 和 串口8 的功能，如果需使用更多高级功能，需要利用 ENV 工具对BSP 进行配置，步骤如下：

1. 在 bsp 目录下打开 env 工具。

2. 输入`menuconfig`命令配置工程，配置好之后保存退出。

3. 输入`scons --target=mdk5`命令构建mdk5工程，

4. 打开工程后重新编译下载即可

## 注意事项

- 开发板的一些功能还未进行测试（基本无遗漏）

## 更新摘要

> 2020.2.16
>> 1. 修复了UART7/8无法使用 DMA 接收的 bug,
>> 2. 添加了 adc1 和 IWDG 设备
>> 3. 更改了文件结构的不合理之处（取消core_board文件）
>> 4. 现在使用scons可以自动添加所需的驱动文件
>> 5. 加入了软件监视器功能

## 联系人信息

维护人:

-  Mqy, 邮箱：<180220214@stu.hit.edu.cn>

核心板制作人
-  XZX，邮箱：<1287285587@qq.com>
